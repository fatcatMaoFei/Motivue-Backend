 
为
LangGraph
驱
动
的
AI
教
练
应
用
打
造
的
专
业
级
架
构
蓝
图
与
提
示
词
手
册
 
 
 
第
一
部
分
：
AI
教
练
中
枢
——LangGraph
架
构
蓝
图
  
本
部
分
旨
在
为
AI
教
练
应
用
构
建
一
个
坚
实
的
基
础
架
构。
我
们
所
设
计
的
并
非
一
个
简
单
的
智
能
体
链
条
，
而
是
一
个
稳
健、
有
状
态
且
具
备
韧
性
的
系
统
，
专
为
处
理
复
杂、
长
期
的
用
户
交
互
而
生。
选
择
“
主
管
-
专
家
”
（
Supervisor-Specialist
）
模
型
是
一
项
战
略
性
决
策
，
旨
在
平
衡
中
心
化
控
制
与
分
布
式
专
业
能
力
，
这
一
模
式
已
在
行
业
最
佳
实
践
中
得
到
验
证。
 
 
1.1.
 
主
管
-
专
家
模
型
：
编
排
与
专
业
分
工
  
 
架
构
论
证
  
本
架
构
将
采
用
**
主
管
（
Supervisor
）
**
模
式。
选
择
此
模
式
是
基
于
其
稳
健
性
和
通
用
性
，
因
为
它
对
下
属
子
智
能
体
的
假
设
最
少
 
1
。
一
个
单
一
的
主
管
智
能
体
将
负
责
管
理
所
有
用
户
交
互
，
并
将
具
体
任
务
委
派
给
一
个
由
专
业
智
能
体
组
成
的
团
队。
这
种
设
计
避
免
了
在
结
构
性
较
弱
的
“
群
体
”
（
Swarm
）
架
构
中
可
能
出
现
的
“
转
译
”
开
销
和
潜
在
的
“
写
入
”
冲
突
，
这
些
问
题
都
可
能
导
致
性
能
下
降
 
1
。
主
管
作
为
用
户
连
贯、
单
一
的
接
触
点
，
这
对
于
需
要
保
持
一
致
人
格
的
教
练
应
用
至
关
重
要。
 
多
智
能
体
系
统
在
处
理
可
并
行
的
“
读
取
”
类
任
务
（如
信
息
检
索、
分
析）
时
表
现
出
色
，
但
在
处
理
涉
及
状
态
变
更
或
需
要
一
致
输
出
的
“
写
入
”
类
任
务
时
，
则
面
临
严
峻
挑
战。
并
行
化
的
写
入
操
作
极
易
产
生
冲
突
，
导
致
结
果
混
乱
 
2
。
从
用
户
的
角
度
看
，
一
次
教
练
对
话
本
质
上
是
一
次
“
写
入
”
任
务
——
用
户
期
望
接
收
到
单
一、
连
贯
的
建
议
流。
一
个
完
全
去
中
心
化
的
群
体
架
构
将
面
临
多
个
智
能
体
试
图
同
时
向
用
户
或
共
享
状
态
“
写
入
”
信
息
的
风
险
，
这
会
引
发
困
惑
和
矛
盾
的
建
议。
主
管
架
构
通
过
设
立
一
个
单
一
的
“
写
入
”
瓶
颈
（即
主
管
智
能
体）
，
同
时
允
许
将
认
知
负
荷
较
重
的
“
读
取
”
和
处
理
任
务
并
行
分
配
给
专
家
智
能
体
，
从
而
巧
妙
地

解
决
了
这
一
核
心
问
题。
因
此
，
该
架
构
直
接
规
避
了
多
智
能
体
系
统
的
一
个
关
键
失
败
模
式
，
使
其
更
适
用
于
教
练
这
类
敏
感
应
用。
 
 
智 能 体 名 册 与 角 色   ●  
主
管
智
能
体
 
(Supervisor
 
Agent):
 
系
统
的
中
央
编
排
者。
负
责
管
理
主
对
话
循
环
，
解
析
用
户
意
图
，
向
专
家
智
能
体
分
派
任
务
，
并
整
合
最
终
的
回
复
内
容。
 ●  
洞
察
与
分
析
智
能
体
 
(Insight
 
&
 
Analysis
 
Agent):
 
专
家
智
能
体
，
负
责
对
用
户
输
入
（如
日
记、
目
标
进
度）
进
行
深
入
的、
数
据
驱
动
的
分
析。
 ●  
策
略
与
规
划
智
能
体
 
(Strategy
 
&
 
Planning
 
Agent):
 
专
家
智
能
体
，
基
于
洞
察
分
析
结
果
，
制
定
可
行
的
行
动
计
划、
策
略
和
教
练
练
习。
 ●  
反
思
与
整
合
智
能
体
 
(Reflection
 
&
 
Synthesis
 
Agent):
 
专
家
智
能
体
，
负
责
总
结
对
话
会
话
，
追
踪
长
期
进
展
，
并
生
成
综
合
报
告。
 
 
LangGraph
 
实
现
  
该
系
统
将
在
LangGraph
中
被
建
模
为
一
个
循
环
图
（
Cyclic
 
Graph
）。
图
中
的
**
节
点
（
Nodes
）
将
代
表
各
个
独
立
的
智
能
体
（主
管、
洞
察
等）
以
及
工
具
调
用
函
数
 
3
。
图
的
边
（
Edges
）
**
将
由
主
管
智
能
体
的
路
由
逻
辑
控
制
，
该
逻
辑
根
据
当
前
状
态
动
态
决
定
下
一
步
的
走
向。
这
种
方
式
赋
予
了
开
发
者
对
“
认
知
架
构
”
的
完
全
控
制
权
，
避
免
了
隐
藏
提
示
词
带
来
的
不
可
预
测
性
 
2
。  
 
1.2.
 
状
态
管
理
与
持
久
化
执
行
：
构
建
一
个
有
韧
性
的
教
练
  
 
定
义
状
态
图
  
我
们
将
为
LangGraph
图
定
义
一
个
全
面
的
State
（状
态）
对
象。
该
对
象
是
一
个
字
典
，
包
含
了
系
统
的
完
整
快
照
：
 ●  
messages:
 
一
个
列
表
，
包
含
对
话
历
史
中
的
所
有
消
息。
 ●  
user_profile:
 
一
个
结
构
化
对
象
，
用
于
存
储
用
户
的
目
标、
偏
好
和
背
景
信
息。
 ●  
session_id:
 
当
前
教
练
会
话
的
唯
一
标
识
符。
 

●  
scratchpad:
 
一
个
字
典
，
供
智
能
体
存
储
中
间
思
考
过
程
和
临
时
结
果。
 ●  
task_queue:
 
一
个
待
办
任
务
列
表
，
供
主
管
智
能
体
进
行
委
派。
 
 
持
久
化
执
行
与
检
查
点
  
智
能
体
系
统
具
有
状
态
性
，
并
且
需
要
长
时
间
运
行
，
这
使
其
在
面
对
系
统
故
障
时
尤
为
脆
弱
，
微
小
的
错
误
也
可
能
滚
雪
球
式
地
演
变
成
灾
难
性
的
失
败
 
2
。
为
了
应
对
这
一
挑
战
，
我
们
的
LangGraph
实
现
将
内
置
检
查
点
（
Checkpointing
）
机
制。
在
每
次
状
态
转
换
后
（例
如
，
一
个
智
能
体
完
成
任
务
后）
，
整
个
状
态
对
象
将
被
序
列
化
并
保
存。
这
一
机
制
使
得
系
统
能
够
在
发
生
错
误
时
从
上
一
个
已
知
的
良
好
状
态
恢
复
（
Resume
）
，
而
不
是
从
头
开
始
，
这
对
于
保
障
长
期、
高
价
值
交
互
的
连
续
性
至
关
重
要
 
2
。
这
一
功
能
将
通
过
LangGraph
内
置
的
持
久
化
模
块
进
行
管
理。
 
 
管
理
长
时
程
上
下
文
  
对
于
一
个
长
期
的
教
练
关
系
而
言
，
单
个
LLM
的
上
下
文
窗
口
是
远
远
不
够
的
 
1
。
我
们
的
状
态
管
理
策
略
将
包
含
上
下
文
压
缩
机
制。
主
管
智
能
体
将
周
期
性
地
调
用
“
反
思
与
整
合
智
能
体
”
，
对
messages
历
史
中
的
旧
有
部
分
进
行
总
结。
这
些
凝
练
的
摘
要
将
替
代
详
细
的
对
话
记
录
，
保
留
在
活
动
状
态
中
，
而
完
整
的
历
史
记
录
则
被
存
入
向
量
数
据
库
，
以
备
将
来
需
要
时
进
行
检
索。
 
 
1.3.
 
智
能
体
通
信
协
议
：
强
制
实
现
无
瑕
交
互
  
 
结
构
化
输
出
的
首
要
地
位
  
可
靠
的
多
智
能
体
系
统
依
赖
于
可
预
测
的、
机
器
可
读
的
通
信。
自
由
格
式
的
文
本
是
脆
弱
且
不
稳
定
的。
因
此
，
所
有
智
能
体
之
间
的
通
信
和
工
具
调
用
都
将
通
过
经
过
严
格
验
证
的
JSON
对
象
进
行
 
4
。  
从
早
期
依
赖
在
提
示
词
中
简
单
指
令
（例
如
，
“
请
用
JSON
格
式
回
应
”
）
的
不
可
靠
方
法
，
到
后
来
引
入
“
修
复
解
析
器
”
（即
用
另
一
次
LLM
调
用
来
修
复
损
坏
的
JSON
）
，
再
到
API
提
供
商
推
出
仅
保
证
语
法
有
效
但
不
保
证
结
构
正
确
的
“JSON
模
式
”
，
LLM
系
统
的
发
展
历
程
清
晰
地
表
明
，
业
界
已
经
认
识
到
，
可
靠
的
进
程
间
通
信
不
能
依
赖
于
概
率
性
的
指
令
 
7
。
最
新
的
演
进
是
API
原
生
的
模
式
强
制
执
行
功
能
，
它
在
生
成
过
程
中
就

约
束
模
型
的
输
出
，
使
其
必
须
符
合
开
发
者
提
供
的
模
式。
这
一
从
概
率
性
的
提
示
工
程
艺
术
到
确
定
性
的
软
件
工
程
科
学
的
范
式
转
变
为
构
建
生
产
级、
可
靠
的
多
智
能
体
系
统
提
供
了
基
石。
对
于
我
们
的
AI
教
练
应
用
，
采
用
这
种
最
先
进
的
方
法
是
确
保
系
统
不
会
因
基
本
的
格
式
错
误
而
失
败
的
必
要
条
件。
 
 
API
原
生
模
式
强
制
执
行
  
我
们
将
利
用
最
稳
健
的
方
法
来
确
保
通
信
的
可
靠
性。
我
们
将
不
再
仅
仅
依
赖
提
示
词
指
令
，
而
是
采
用
API
原
生
功
能
，
如
OpenAI
的
结
构
化
输
出
（在
response_format
中
指
定
json_schema
）
或
Anthropic
的
工
具
使
用
模
式
 
9
。
这
些
功
能
在
生
成
层
面
就
对
模
型
的
输
出
进
行
约
束
，
提
供
了
接
近
100%
的
可
靠
性
，
并
消
除
了
对
脆
弱
的
解
析
和
修
复
循
环
的
需
求
 
8
。  
 
使
用
Pydantic
进
行
模
式
定
义
与
验
证
  
所
有
的
JSON
模
式
都
将
在
Python
代
码
库
中
定
义
为
Pydantic
模
型。
这
为
数
据
结
构
提
供
了
单
一
事
实
来
源
，
支
持
静
态
分
析
，
并
提
供
自
动
验
证。
LangChain
的
.
with_structured_output()
方
法
能
够
直
接
与
Pydantic
模
型
集
成
，
将
成
为
我
们
确
保
模
式
遵
循
性
的
主
要
接
口
 
12
。  
 
表 1 ： 核 心 通 信 模 式  (Pydantic 模 型 )   
下
表
定
义
了
智
能
体
之
间
通
信
的
“API
合
约
”
，
它
将
抽
象
的
“
通
信
”
概
念
具
体
化
为
可
实
现
的
代
码。
预
先
定
义
这
些
模
式
可
以
确
保
系
统
范
围
的
一
致
性
，
减
少
集
成
错
误
，
并
为
开
发
工
作
创
建
一
个
清
晰
的
蓝
图。
这
不
仅
仅
是
文
档
，
而
是
强
制
系
统
可
靠
性
的
核
心
架
构
构
件。
 
Pydantic
类
名
 用 途  
关
键
字
段
 
(
名
称
:
 
类
型
,
 
描
述
)
 
TaskDelegation  
主
管
 
->
 
专
家。
分
配
一
个
具
体
任
务。
 
task_id:
 
str
 
(
任
务
唯
一
ID),
 task_description:  str  ( 清 晰
的
任
务
描
述
),
 
input_data:
 
dict
 
(
完
成
任
务
所
需
的
数
据
),
 schema_for_output:  dict  
(
期
望
输
出
的
JSON
模
式
)
 

AnalysisResult  洞 察 智 能 体  ->  主 管。 返 回 分
析
发
现。
 
task_id:
 
str
 
(
对
应
的
任
务
ID),
 
summary:
 
str
 
(
发
现
摘
要
),
 key_insights:  list[str]  ( 核 心洞 察 列 表 ),  hypotheses_tested:  
list[dict]
 
(
被
检
验
的
假
设
及
其
证
据
)
 
ActionPlan  策 略 智 能 体  ->  主 管。 提 供 一
份
教
练
计
划。
 
task_id:
 
str
 
(
对
应
的
任
务
ID),
 
plan_title:
 
str
 
(
计
划
标
题
),
 steps:  list[dict]  ( 包 含 具 体 步
骤、
原
理
和
衡
量
标
准
的
列
表
),
 
rationale:
 
str
 
(
计
划
背
后
的
整
体
逻
辑
)
 
SessionSummary  反 思 智 能 体  ->  主 管。 提 交 一
份
会
话
总
结。
 
session_id:
 
str
 
(
会
话
ID),
 
key_topics:
 
list[str]
 
(
讨
论
的
关
键
主
题
),
 
action_items:
 
list[str]
 
(
商
定
的
行
动
项
),
 
user_sentiment:
 
str
 
(
用
户
情
绪
评
估
)
 
 
第
二
部
分
：
提
示
词
手
册
——
工
程
化
教
练
智
能
体
的
思
维
  
本
部
分
提
供
了
为
每
个
智
能
体
精
心
设
计
的、
专
业
级
的
完
整
提
示
词。
每
个
提
示
词
都
是
一
个
结
合
了
角
色
设
定、
任
务
指
令、
约
束
条
件
和
先
进
推
理
技
术
的
复
杂
“
认
知
程
序
”
，
旨
在
引
导
LLM
产
生
期
望
的
行
为。
 
 
2.1.
 
主
管
智
能
体
：
编
排
者
  
 
核
心
身
份
与
系
统
提
示
词
  

此
提
示
词
确
立
了
该
智
能
体
作
为
用
户
主
要
AI
教
练
的
人
格。
它
将
定
义
其
沟
通
风
格
（共
情、
清
晰、
鼓
励）
及
其
核
心
任
务
：
理
解
用
户
的
需
求
，
并
协
调
一
个
内
部
专
家
团
队
以
提
供
最
佳
支
持。
提
示
词
将
明
确
指
示
，
它
绝
不
应
自
行
进
行
分
析
或
规
划
，
而
必
须
始
终
将
这
些
任
务
委
派
给
专
家。
 
系
统
提
示
词
示
例
:
 
 
  
你
是
一
个
名
为
“
启
航
”
的
AI
教
练
，
你
的
角
色
是
用
户
的
私
人
成
长
伙
伴。
你
的
沟
通
风
格
是
温
暖、
共
情
且
富
有
洞
察
力
的。
你
的
核
心
使
命
是
：
 
1.
  
深
入
理
解
用
户
的
目
标、
挑
战
和
情
感
状
态。
 
2.
  
管
理
一
个
由
内
部
专
家
智
能
体
组
成
的
团
队
，
每
个
智
能
体
都
在
特
定
领
域
（如
数
据
分
析、
策
略
规
划、
反
思
总
结）
拥
有
深
厚
的
专
业
知
识。
 
3.
  
当
你
收
到
用
户
的
请
求
时
，
你
的
首
要
任
务
是
判
断
需
要
哪
位
专
家
的
能
力
来
最
好
地
回
应
用
户。
你
必
须
将
复
杂
的
分
析
和
规
划
任
务
委
派
给
相
应
的
专
家。
 
4.
  
在
收
到
专
家
的
反
馈
后
，
你
负
责
将
其
整
合
成
一
个
清
晰、
连
贯
且
对
用
户
有
帮
助
的
回
复。
 
5.
  
你
绝
不
能
自
己
进
行
深
入
的
数
据
分
析
或
制
定
详
细
的
行
动
计
划。
你
的
专
长
在
于
倾
听、
理
解
和
协
调。
你
是
一
个
引
导
者
，
而
不
是
一
个
全
能
的
解
决
者。
 
  
任
务
提
示
词
 
(
动
态
生
成
)
  ●  
用
户
意
图
分
析
与
路
由
提
示
词
:
 
此
提
示
词
在
每
个
对
话
回
合
开
始
时
使
用。
它
接
收
最
新
的
用
户
消
息
和
对
话
历
史
作
为
输
入
，
目
标
是
分
类
用
户
的
意
图
（例
如
，
“
情
绪
宣
泄
”
、
“
请
求
计
划
”
、
“
进
度
汇
报
”
、
“
提
问
”
）
，
并
决
定
下
一
步
行
动。
输
出
将
是
一
个
结
构
化
的
JSON
对
象
，
指
明
接
下
来
应
调
用
哪
个
专
家
智
能
体
（或
者
，
对
于
简
单
的
问
候
等
，
由
主
管
直
接
处
理）。
这
利
用
了
将
复
杂
任
务
分
解
的
原
则
 
2
。 
动
态
生
成
指
令
示
例
: JSON {  
  "task":  "Analyze  user  intent  and  determine  routing",  
  "user_message":  "{latest_user_message}",  
  "conversation_history":  "{recent_conversation_history}",  
  "available_agents":,  
  "output_schema":  {  
    "type":  "object",  
    "properties":  {  
      "user_intent":  {  
        "type":  "string",  

        "description":  "A  concise  classification  of  the  user's  primary  intent.",  
        "enum":  ["emotional_venting",  "request_for_plan",  "progress_update",  "clarifying_question",  "general_chat"]  
      
},
 
      "next_agent":  {  
        "type":  "string",  
        "description":  "The  name  of  the  agent  best  suited  to  handle  this  intent.",  
        "enum":  
      
},
 
      "rationale":  {  
        "type":  "string",  
        "description":  "A  brief  explanation  for  the  routing  decision." 
      
}
 
    
},
 
    "required":  ["user_intent",  "next_agent",  "rationale"]  
  
}
 
}
 
 ●  
任
务
分
解
与
委
派
提
示
词
:
 
一
旦
确
定
了
下
一
个
智
能
体
，
主
管
将
使
用
此
提
示
词
来
构
建
TaskDelegation
对
象。
它
会
将
用
户
的
自
然
语
言
请
求
转
化
为
一
个
对
专
家
来
说
精
确、
无
歧
义
的
任
务
描
述
，
并
包
含
状
态
图
中
所
有
必
要
的
上
下
文。
这
是
避
免
因
指
令
模
糊
而
导
致
子
智
能
体
表
现
不
佳
的
关
键
步
骤
 
2
。  
 
2.2.  洞 察 与 分 析 智 能 体 ： 数 据 科 学 家   
 
核
心
身
份
与
系
统
提
示
词
  
系
统
提
示
词
示
例
:
 
 
  
你
是
一
位
顶
尖
的
数
据
科
学
家
和
定
性
研
究
员。
你
的
专
长
是
分
析
文
本
数
据
，
以
揭
示
其
潜
在
的
模
式、
主
题
和
因
果
关
系。
你
的
工
作
方
式
是
客
观、
循
证
且
严
谨
的。
你
从
不
提
供
建
议
或
个
人
观
点
；
你
只
呈
现
经
过
整
合
的
发
现。
你
的
输
出
必
须
严
格
遵
守
所
提
供
的
JSON
模
式。
 

  
任
务
提
示
词
：
思
维
树
 
(ToT)
 
用
于
深
度
洞
察
生
成
  
此
提
示
词
是
思
维
树
（
Tree-of-Thoughts,
 
ToT
）
框
架
的
直
接
实
现
，
用
于
分
析
复
杂
的
用
户
输
入
（如
一
篇
长
日
记）。
它
将
引
导
LLM
通
过
一
个
多
步
骤
的
推
理
过
程
，
旨
在
克
服
单
路
径、
线
性
推
理
的
局
限
性
 
14
。  ●  
第
一
步
：
思
维
分
解
与
生
成
 
(Thought
 
Decomposition
 
&
 
Generation)
。
 
“
根
据
用
户
提
供
的
文
本
，
生
成
3
个
不
同
的、
高
层
次
的
假
设
，
这
些
假
设
可
以
解
释
用
户
当
前
的
挑
战
或
感
受。
假
设
必
须
是
可
检
验
的
陈
述。
例
如
：
‘
假
设
1
：
用
户
的
压
力
源
于
其
对
工
作
项
目
感
知
到
的
失
控
感。
’
‘
假
设
2
：
用
户
的
挫
败
感
与
其
价
值
观
和
日
常
活
动
之
间
的
不
匹
配
有
关。
’”
 
这
一
步
使
用
了
ToT
中
的
**
采
样
（
Sampling
）
**
技
术
，
以
生
成
一
个
多
样
化
的
思
维
空
间
 
16
。  ●  
第
二
步
：
状
态
评
估
 
(State
 
Evaluation)
。
 
“
对
于
这
3
个
假
设
中
的
每
一
个
，
系
统
性
地
在
所
提
供
的
文
本
中
搜
索
，
并
列
出
所
有
支
持
或
反
驳
它
的
证
据
片
段。
评
估
每
个
假
设
的
证
据
强
度
，
并
为
其
分
配
一
个
1
到
5
的
置
信
度
分
数。
请
以
结
构
化
的
格
式
呈
现
此
评
估
过
程。
”
 
这
一
步
强
制
模
型
对
其
自
己
生
成
的
想
法
进
行
审
慎
的
自
我
评
估
 
15
。  ●  
第
三
步
：
综
合
与
剪
枝
 
(Synthesis
 
&
 
Pruning)
。
 
“
基
于
你
的
证
据
评
估
，
选
择
最
可
信
的
假
设。
如
果
多
个
假
设
都
得
到
了
充
分
支
持
，
请
解
释
它
们
之
间
可
能
存
在
的
相
互
联
系。
将
你
的
发
现
整
合
成
一
份
关
于
核
心
洞
察
的
简
明
摘
要
，
明
确
指
出
用
户
状
况
的
主
要
驱
动
因
素。
丢
弃
置
信
度
低
的
假
设。
”
 
这
一
步
模
拟
了
ToT
中
的
搜
索
和
回
溯
/
剪
枝
过
程
 
16
。  
最
终
，
该
智
能
体
的
输
出
将
是
一
个
严
格
遵
循
模
式
的
AnalysisResult
 
JSON
对
象。
 
 
2.3.
 
策
略
与
规
划
智
能
体
：
教
练
  
 
核
心
身
份
与
系
统
提
示
词
  
系
统
提
示
词
示
例
:
 
 
  
你
是
一
位
经
过
认
证
的
专
业
教
练
，
擅
长
创
建
可
行
的、
个
性
化
的
发
展
计
划。
你
富
有
同
理
心、
激
励
人
心
且

注
重
实
效。
你
的
主
要
目
标
是
通
过
将
宏
大
目
标
分
解
为
可
管
理
的
步
骤
来
赋
能
用
户。
你
严
格
遵
守
已
建
立
的
教
练
框
架
，
如
SMART
（具
体
的、
可
衡
量
的、
可
实
现
的、
相
关
的、
有
时
限
的）
原
则。
 
  
任
务
提
示
词
：
带
有
批
判
性
反
思
的
自
我
精
炼
 
(Self-Refine
 
with
 
Critique)
 
用
于
高
质
量
计
划
  
简
单
地
要
求
LLM
给
出
一
个
“
好
计
划
”
是
不
可
靠
的。
“
自
我
精
炼
”
模
式
将
“
好
”
这
个
抽
象
概
念
解
构
成
一
个
具
体
的、
可
验
证
的
检
查
清
单。
这
使
得
模
型
的
推
理
过
程
外
部
化
，
从
而
更
加
透
明
和
可
控。
它
还
降
低
了
模
型
偏
爱
其
最
初
有
缺
陷
的
回
答
的
风
险
（即
自
我
偏
见）
，
因
为
它
被
迫
根
据
一
套
外
部
原
则
进
行
评
估
 
19
。  
这
个
过
程
的
价
值
在
于
，
它
将
一
个
单
次
通
过
的
“
黑
箱
”
生
成
任
务
转
变
为
一
个
多
步
骤
的、
透
明
的
认
知
过
程。
第
一
步
是
初
步
的、
可
能
存
在
缺
陷
的
生
成。
第
二
步
强
制
LLM
扮
演
一
个
不
同
的
角
色
（
质
量
保
证
审
查
员）
，
并
使
用
一
种
不
同
的
认
知
过
程
（
对
照
标
准
进
行
评
估
，
而
非
自
由
生
成）。
这
种
明
确
的
批
判
指
令
使
评
估
过
程
变
得
透
明。
第
三
步
则
利
用
这
种
结
构
化
的
反
馈
来
指
导
有
针
对
性
的
修
订
，
这
远
比
一
个
模
糊
的
“
让
它
变
得
更
好
”
的
指
令
有
效
得
多。
它
将
一
个
不
可
靠
的
创
造
性
任
务
，
转
变
为
一
个
更
可
靠
的、
准
算
法
化
的
流
程
 
21
。  ●  第 一 步 ： 生 成 初 始 草 案  (Initial  Draft  Generation) 。  “ 基 于 提 供 的 AnalysisResult ， 生 成 一 份
行
动
计
划
草
案
，
包
含
3-5
个
用
户
在
接
下
来
一
周
可
以
采
取
的
具
体
步
骤。
为
每
个
步
骤
提
供
简
要
的
理
由。
”
 ●  
第
二
步
：
结
构
化
自
我
批
判
 
(Structured
 
Self-Critique)
。
 
“
现
在
，
扮
演
一
名
质
量
保
证
审
查
员
的
角
色。
根
据
以
下
标
准
，
严
格
评
估
你
刚
才
创
建
的
计
划
草
案。
对
每
条
标
准
，
回
答
‘
通
过
’
或
‘
失
败
’
，
并
给
出
一
句
理
由。
 ○  
标
准
1
 
(
具
体
性
):
 
每
个
步
骤
是
否
完
全
无
歧
义？
 ○  
标
准
2
 
(
可
衡
量
性
):
 
是
否
有
明
确
的
方
法
来
判
断
步
骤
是
否
已
完
成？
 ○  
标
准
3
 
(
可
实
现
性
):
 
对
于
处
于
用
户
当
前
状
况
的
人
来
说
，
这
个
步
骤
是
否
现
实？
 ○  
标
准
4
 
(
相
关
性
):
 
该
步
骤
是
否
直
接
解
决
了
分
析
中
的
核
心
洞
察？
 ○  
标
准
5
 
(
以
用
户
为
中
心
):
 
计
划
是
否
尊
重
了
用
户
明
确
提
出
的
限
制
和
偏
好？
”
 ●  
第
三
步
：
最
终
计
划
精
炼
 
(Final
 
Plan
 
Refinement)
。
 
“
根
据
你
的
批
判
性
评
估
，
生
成
最
终
的
ActionPlan
 
JSON
对
象。
重
写
所
有
在
评
估
中
‘
失
败
’
的
步
骤
，
以
解
决
已
识
别
的
缺
陷。
如
果
所
有
步
骤
都
‘
通
过
’
，
则
重
新
提
交
原
始
计
划。
”
 
这
个
迭
代
过
程
将
一
个
简
单
的
生
成
任
务
转
变
为
一
个
动
态
的
评
估
和
改
进
循
环
 
23
。  
 
2.4.
 
反
思
与
整
合
智
能
体
：
记
录
员
  
 

核
心
身
份
与
系
统
提
示
词
  
系
统
提
示
词
示
例
:
 
 
  
你
是
一
位
一
丝
不
苟
的
记
录
员
和
报
告
员。
你
唯
一
的
目
标
是
创
建
清
晰、
简
洁
且
事
实
准
确
的
对
话
摘
要。
你
保
持
客
观
，
不
添
加
任
何
解
释
或
个
人
观
点。
你
的
工
作
成
果
必
须
能
够
与
源
对
话
记
录
进
行
核
实
验
证。
 
  
任
务
提
示
词
：
验
证
链
 
(CoVe)
 
用
于
事
实
性
总
结
  
此
提
示
词
确
保
生
成
的
摘
要
基
于
事
实
，
不
含
幻
觉
，
这
对
于
准
确
追
踪
用
户
进
展
至
关
重
要。
它
是
验
证
链
（
Chain-of-Verification,
 
CoVe
）
模
式
的
直
接
实
现
 
20
。  ●  
第
一
步
：
生
成
基
线
摘
要
 
(Generate
 
Baseline
 
Summary)
。
 
“
阅
读
所
提
供
的
会
话
记
录
，
并
生
成
一
份
摘
要
草
稿
，
涵
盖
讨
论
的
关
键
主
题、
做
出
的
决
定
以
及
商
定
的
行
动
项。
”
 ●  
第
二
步
：
生
成
验
证
性
问
题
 
(Generate
 
Verification
 
Questions)
。
 
“
基
于
你
的
摘
要
草
稿
，
生
成
一
个
问
题
列
表。
这
些
问
题
必
须
可
以
通
过
查
阅
原
始
记
录
以
‘
是
’
或
‘
否
’
来
回
答
，
旨
在
验
证
你
摘
要
中
的
关
键
声
明。
例
如
：
‘
用
户
是
否
明
确
同
意
了
行
动
项
X
？
’
‘
主
题
Y
是
否
是
对
话
前
半
部
分
的
主
要
焦
点？
’”
 ●  
第
三
步
：
回
答
验
证
性
问
题
 
(Answer
 
Verification
 
Questions)
。
 
“
通
过
引
用
原
始
记
录
中
的
具
体
段
落
来
回
答
你
刚
才
生
成
的
每
一
个
验
证
性
问
题。
如
果
找
不
到
直
接
引
文
，
请
回
答
‘
不
确
定
’
。
”
 ●  
第
四
步
：
生
成
最
终
的、
经
过
验
证
的
摘
要
 
(Generate
 
Final,
 
Verified
 
Summary)
。
 
“
回
顾
你
的
基
线
摘
要
和
你
对
验
证
性
问
题
的
回
答。
编
辑
摘
要
以
纠
正
任
何
不
准
确
之
处
，
或
删
除
任
何
被
标
记
为
‘
不
确
定
’
的
声
明。
生
成
最
终
的
SessionSummary
 
JSON
对
象。
”
 
这
个
过
程
强
制
智
能
体
将
其
自
身
的
陈
述
与
源
材
料
进
行
交
叉
引
用
，
从
而
显
著
提
高
了
输
出
的
事
实
可
靠
性
 
20
。  
 
结
论
与
建
议
  
本
报
告
为
构
建
一
个
基
于
LangGraph
的
专
业
级
AI
教
练
应
用
提
供
了
一
套
全
面
的
架
构
蓝
图
和
提
示
词
工
程
策
略。
其
核
心
设
计
理
念
在
于
通
过
结
合
稳
健
的
系
统
架
构
与
先
进
的
LLM
推
理
技
术
，
来
应
对
构
建
复
杂、
可
靠
AI
智
能
体
所
面
临
的
挑
战。
 

核
心
架
构
原
则
：
 1.  
采
用
主
管
-
专
家
模
型
：
 
这
是
实
现
控
制
与
专
业
能
力
平
衡
的
关
键。
通
过
中
心
化
用
户
交
互
（写
入）
和
分
布
式
任
务
处
理
（
读
取）
，
该
架
构
在
根
本
上
提
升
了
系
统
的
连
贯
性
和
可
靠
性。
 2.  
实
施
持
久
化
状
态
管
理
：
 
对
于
需
要
长
期
交
互
的
应
用
，
通
过
检
查
点
机
制
实
现
持
久
化
执
行
是
必
不
可
少
的。
这
确
保
了
系
统
的
韧
性
，
保
护
了
用
户
交
互
的
价
值。
 3.  
强
制
执
行
结
构
化
通
信
：
 
智
能
体
间
的
通
信
必
须
从
依
赖
概
率
性
的
提
示
词
指
令
，
转
向
依
赖
确
定
性
的、
API
原
生
的
模
式
强
制
执
行。
使
用
Pydantic
模
型
和
with_structured_output
等
工
具
，
是
构
建
生
产
级
系
统
的
基
石。
 
核
心
提
示
词
工
程
策
略
：
 1.  
思
维
树
 
(ToT)
 
用
于
深
度
分
析
：
 
对
于
需
要
探
索
性
分
析
的
复
杂
任
务
，
ToT
通
过
模
拟
人
类
的
假
设
-
验
证
过
程
，
能
够
产
出
远
超
线
性
思
维
的
深
刻
洞
察。
 2.  
自
我
精
炼
 
(Self-Refine)
 
用
于
高
质
量
生
成
：
 
通
过
引
入
结
构
化
的
自
我
批
判
循
环
，
可
以
将
抽
象
的
质
量
要
求
转
化
为
具
体
的、
可
执
行
的
评
估
标
准
，
从
而
显
著
提
升
生
成
内
容
的
质
量
和
可
靠
性。
 3.  
验
证
链
 
(CoVe)
 
用
于
事
实
准
确
性
：
 
在
任
何
需
要
事
实
性
陈
述
的
场
景
（如
总
结
报
告）
，
CoVe
通
过
强
制
模
型
对
其
声
明
进
行
溯
源
验
证
，
是
抑
制
模
型
幻
觉、
确
保
内
容
真
实
性
的
有
效
手
段。
 
综
上
所
述
，
成
功
构
建
一
个
强
大
的
AI
教
练
应
用
，
不
仅
需
要
选
择
正
确
的
工
具
（如
LangGraph
）
，
更
需
要
采
纳
一
套
系
统
性
的
设
计
哲
学。
这
套
哲
学
强
调
通
过
明
确
的
架
构
约
束
来
管
理
复
杂
性
，
并
通
过
工
程
化
的
提
示
词
来
引
导
LLM
的
认
知
过
程
，
最
终
将
AI
智
能
体
的
构
建
从
一
门
艺
术
，
转
变
为
一
门
更
加
可
靠
和
可
预
测
的
工
程
学
科。
 
Works  cited  
1.  Benchmarking  Multi-Agent  Architectures  -  LangChain  Blog,  accessed  October  9,  2025,  https://blog.langchain.com/benchmarking-multi-agent-architectures/ 2.  How  and  when  to  build  multi-agent  systems  -  LangChain  Blog,  accessed  October  
9,
 
2025,
 https://blog.langchain.com/how-and-when-to-build-multi-agent-systems/ 3.  Basic  Multi-agent  Collaboration  -  GitHub  Pages,  accessed  October  9,  2025,  https://langchain-ai.github.io/langgraphjs/tutorials/multi_agent/multi_agent_collaboration/ 4.  Is  JSON  Prompting  a  Good  Strategy?  -  PromptLayer  Blog,  accessed  October  9,  2025,  https://blog.promptlayer.com/is-json-prompting-a-good-strategy/ 5.  Enhance  AI  Models  Prompt  Engineering  with  JSON  Output  |  by  Novita  AI  -  
Medium,
 
accessed
 
October
 
9,
 
2025,
 https://medium.com/@marketing_novita.ai/enhance-ai-models-prompt-engineering-with-json-output-ca450f62159a 6.  For  Best  Results  with  LLMs,  Use  JSON  Prompt  Outputs  |  HackerNoon,  accessed  
October
 
9,
 
2025,
 https://hackernoon.com/for-best-results-with-llms-use-json-prompt-outputs 7.  How  to  get  100%  valid  JSON  answers?  -  Prompting  -  OpenAI  Developer  
Community,
 
accessed
 
October
 
9,
 
2025,
 https://community.openai.com/t/how-to-get-100-valid-json-answers/554379 

8.  How  to  use  the  output-fixing  parser  |  🦜  LangChain,  accessed  October  9,  2025,  https://python.langchain.com/docs/how_to/output_parser_fixing/ 9.  Introducing  Structured  Outputs  in  the  API  -  OpenAI,  accessed  October  9,  2025,  https://openai.com/index/introducing-structured-outputs-in-the-api/ 10.  The  guide  to  structured  outputs  and  function  calling  with  LLMs  -  Agenta,  
accessed
 
October
 
9,
 
2025,
 https://agenta.ai/blog/the-guide-to-structured-outputs-and-function-calling-with-llms 11.  Ensuring  Consistent  JSON  Output  from  LLMs  on  Amazon  Bedrock  |  AWS  Builder  
Center,
 
accessed
 
October
 
9,
 
2025,
 https://builder.aws.com/content/2wWabHxa0No1ZveOI7lMjQg6APP/ensuring-consistent-json-output-from-llms-on-amazon-bedrock 12.  How  to  return  structured  data  from  a  model  |  🦜  LangChain,  accessed  October  9,  2025,  https://python.langchain.com/docs/how_to/structured_output/ 13.  Structured  Outputs  from  LLM  using  Pydantic  |  by  Harisudhan.S  -  Medium,  
accessed
 
October
 
9,
 
2025,
 https://medium.com/@speaktoharisudhan/structured-outputs-from-llm-using-pydantic-1a36e6c3aa07 14.  Chain-of-Thought  Prompting  Elicits  Reasoning  in  Large  Language  Models  -  arXiv,  accessed  October  9,  2025,  https://arxiv.org/abs/2201.11903 15.  Tree  of  Thoughts:  Deliberate  Problem  Solving  with  Large  Language  Models  -  arXiv,  accessed  October  9,  2025,  https://arxiv.org/abs/2305.10601 16.  What  is  Tree  Of  Thoughts  Prompting?  |  IBM,  accessed  October  9,  2025,  https://www.ibm.com/think/topics/tree-of-thoughts 17.  Tree  of  Thoughts  (ToT)  -  Prompt  Engineering  Guide,  accessed  October  9,  2025,  https://www.promptingguide.ai/techniques/tot 18.  [2305.08291]  Large  Language  Model  Guided  Tree-of-Thought  -  arXiv,  accessed  October  9,  2025,  https://arxiv.org/abs/2305.08291 19.  Self-correction  in  LLM  calls:  a  review  -  The  Elder  Scripts,  accessed  October  9,  2025,  https://theelderscripts.com/self-correction-in-llm-calls-a-review/ 20.  Introduction  to  Self-Criticism  Prompting  Techniques  for  LLMs,  accessed  October  9,  2025,  https://learnprompting.org/docs/advanced/self_criticism/introduction 21.  Training  Language  Models  to  Self-Correction  via  Reinforcement  Learning:  A  Deep  
Dive
 
into
 
SCoRe
 
with
 
Code
 
Implementation
 
using
 
PyTorch.
 
|
 
by
 
Devmallya
 
Karar
 
|
 
Medium,
 
accessed
 
October
 
9,
 
2025,
 https://medium.com/@devmallyakarar/training-language-models-to-self-correction-via-reinforcement-learning-a-deep-dive-into-score-with-ff85421b4186 22.  Understanding  the  Dark  Side  of  LLMs'  Intrinsic  Self-Correction  -  arXiv,  accessed  October  9,  2025,  https://arxiv.org/html/2412.14959v1 23.  Mastering  Self-Criticism  Prompting:  Techniques,  Examples,  and  Use  Cases  -  RAIA  
A.I.,
 
accessed
 
October
 
9,
 
2025,
 https://raiabot.com/blog/Mastering_SelfCriticism_Prompting_Techniques_Examples_and_Use_Cases.html 